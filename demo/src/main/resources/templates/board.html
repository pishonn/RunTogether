<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>ê²Œì‹œíŒ</title>
    <style>
        
        .container {
            width: 700px; 
            text-align: center;
            justify-content: center;
        }

        table {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
            border: 1px solid transparent;
            table-layout: auto;
            margin-bottom: 20px;
        }
        th, td {
            border-bottom: 1px solid black;
            padding: 15px;
            text-align: center;
            background-color: transparent; 
            word-wrap: break-word;
            white-space: normal;
            vertical-align: middle;
        }

        #button {
            width: 80px;
            background-color: #007bff;
            color: white;
            border-radius: 20px;
            text-align: center;
            text-decoration: none;
            margin-bottom: 20px;
            border-radius: 30px;
            float: right;
            margin-left: 10px;
        }
        
        .write-btn, .profile-btn, .logout-btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            margin-top: 10px;
            margin-bottom: 20px;
            border-radius: 30px;
            float: right;
            margin-left: 10px;
        }
        .buttons-container {
            display: flex;
            justify-content: flex-end;
            padding-bottom: 20px;
        }
        .post-title {
            color: black; 
            font-weight: bold; 
            text-decoration: none; 
        }

        .post-writer {
            color: black; 
            text-decoration: none; 
        }

        /* ìˆ˜ì •ì„ ìœ„í•œ CSS */
        .profile-img {
            overflow: hidden;
            max-width: 30px; /* ì›ë˜ ì‚¬ì´ì¦ˆ ìœ ì§€ */
            max-height: 30px; /* ì›ë˜ ì‚¬ì´ì¦ˆ ìœ ì§€ */
            width: 60px; /* ì›ë˜ ì‚¬ì´ì¦ˆ ìœ ì§€ */
            height: 60px; /* ì›ë˜ ì‚¬ì´ì¦ˆ ìœ ì§€ */
            border-radius: 50%;
            margin-right: 5px;
            display: inline-block; /* ì´ë¯¸ì§€ê°€ inline ìš”ì†Œë¡œ ì²˜ë¦¬ë˜ë„ë¡ í•¨ */
            vertical-align: middle; /* ì´ë¯¸ì§€ë¥¼ ì¤‘ê°„ì— ì •ë ¬ *
        }
        .profile-img img {
            object-fit: cover; /* ì´ë¯¸ì§€ í™•ëŒ€ ë° ì˜ë ¤ ë³´ì´ê²Œ í•˜ê¸° */
            object-position: center; /* ì¤‘ì‹¬ì— ë§ì¶”ê¸° */
        }
        .writer-info {
            display: inline-block;
            vertical-align: middle; /* ì „ì²´ ì»¨í…Œì´ë„ˆ ì •ë ¬ */
            line-height: 30px; /* ì´ë¯¸ì§€ ë†’ì´ì™€ ë™ì¼í•œ ë¼ì¸ ë†’ì´ */
        }

        .pagination a {
            margin: 0 5px;
            text-decoration: none;
            cursor: pointer;
            color: black;
        }
        .pagination .active {
            font-weight: bold;
            color: #007bff;
        }
        
        #search-box {
            width: 50%;
            padding: 10px;
            margin-top: 20px;
            box-sizing: border-box;
        }
        .tab-container {
            float: left;
            margin-top: 30px;
            margin-left: 10px;
            display: inline-flex;
        }
        .tab {
            font-size: 15px;
            margin-left: 5px;
            margin-right: 5px;
            color: black; 
            text-decoration: none;
            color: #adb5bd;
            outline: none;
        }
      
        .back-button2 {
            position: relative;
            float: right;
        }
        .black-tab {
            color: black;
            font-weight: bold;
        }
        
        .gray-tab {
        }
        
    </style>
</head>
<body>
    <div class="container">
        <button type="button" th:onclick="|window.location.href='@{/}'|" class="back-button2"><img src="./img/arrow.png"></button>

        <div class="buttons-container">
            <a href="/profile" class="profile-btn" th:if="${session.user}">í”„ë¡œí•„ ìˆ˜ì •</a>
            <a href="/logout" class="logout-btn" th:if="${session.user}">ë¡œê·¸ì•„ì›ƒ</a>
        </div>
        <h1>ê²Œì‹œíŒ</h1>
        <div class="tab-container">
            <a href="/board?type=free" class="tab" th:classappend="${type == 'free'} ? 'active black-tab' : 'gray-tab'">ììœ ê²Œì‹œíŒ</a>
            <a> / </a>
            <a href="/board?type=crew" class="tab" th:classappend="${type == 'crew'} ? 'active black-tab' : 'gray-tab'">í¬ë£¨ ëª¨ì§‘</a>
        </div>            
        <a th:href="@{/write(type=${type})}" id="button">ê¸€ì“°ê¸°</a>
        <table>
            <tr>
                <th>ì œëª©</th>
                <th>ì‘ì„±ì</th>
                <th>ë‚ ì§œ</th>
            </tr>
            <tr th:if="${not #lists.isEmpty(posts)}" th:each="post : ${posts}">
                <td>
                    <a th:href="@{/post/{id}(id=${post.id})}" th:text="${post.title}" class="post-title">ê²Œì‹œë¬¼ ì œëª©</a>
                </td>
                <td>
                    <a th:href="@{/profile/{id}(id=${post.userId})}" style="text-decoration: none;">
                        <img th:src="@{/img/default-profile{profileImg}.jpg(profileImg=${post.profileImg})}" alt="í”„ë¡œí•„ ì‚¬ì§„" class="profile-img">
                    </a>
                    <a th:href="@{/profile/{id}(id=${post.userId})}" style="cursor: pointer;" th:text="${post.writer}" class="post-writer">ê²Œì‹œë¬¼ ì‘ì„±ì</a>
                </td>                
                <td th:text="${#temporals.format(post.date, 'yyyy-MM-dd HH:mm:ss')}">ê²Œì‹œë¬¼ ë‚ ì§œ</td>
            </tr>
            <tr th:if="${#lists.isEmpty(posts)}">
                <td colspan="3">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
        </table>
        <div class="pagination">
            <a th:if="${currentPage > 1}" th:href="@{/board(page=${currentPage - 2})}">ì´ì „</a> <!-- currentPagesëŠ” ë·°ì— ì „ë‹¬ë  ë•Œì—ëŠ” +1 ë˜ì–´ ì „ë‹¬ë˜ê³  (ë·°ì— í‘œê¸°ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸), ë‹¤ì‹œ ì„œë²„ì— ì „ë‹¬í•  ë•ŒëŠ” 0ë² ì´ìŠ¤ë¡œ ì „ë‹¬í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— 1ì˜ ì°¨ì´ê°€ ë‚˜ê²Œë¨, ë”°ë¼ì„œ -1 í˜ì´ì§€ë¥¼ ìš”ì²­í•˜ë ¤ë©´ -2ë¥¼ í•´ì•¼í•¨ -->
            <a th:each="i : ${#numbers.sequence(startPage, endPage)}"
               th:classappend="${i == currentPage} ? 'active'"
               th:href="@{/board(page=${i - 1})}"
               th:text="${i}"></a>
            <a th:if="${currentPage < totalPages}" th:href="@{/board(page=${currentPage})}">ë‹¤ìŒ</a>
        </div>
        <form action="/board" method="get">
            <input type="hidden" name="type" th:value="${type}"/>
            <input type="text" id="search-box" name="search" placeholder="ğŸ” ê²€ìƒ‰ì–´ ì…ë ¥ í›„ Enter" th:value="${search}" />
        </form>
    </div>
</body>
<script th:if="${message}">
    alert('[[${message}]]');
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchBox = document.getElementById('search-box');
        const typeInput = document.querySelector('input[name="type"]');
        const type = typeInput ? typeInput.value : '';

        searchBox.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // ì—”í„° í‚¤ì˜ ê¸°ë³¸ ë™ì‘ì¸ í¼ ì œì¶œ ì œí•œ
                const searchValue = searchBox.value.trim();
                // í˜„ì¬ URLì— ê²€ìƒ‰ì–´ ì¶”ê°€í•˜ê³  ìƒˆë¡œê³ ì¹¨í•¨
                if (type) {
                    window.location.href = window.location.pathname + '?type=' + type + '&search=' + encodeURIComponent(searchValue);
                } else {
                    window.location.href = window.location.pathname + '?search=' + encodeURIComponent(searchValue);
                }
            }
        });
    });
</script>
</html>
